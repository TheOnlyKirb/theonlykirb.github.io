<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Advanced Bot Setup | The Watchpost</title>
  <meta name="author" content="AJ Nicoloff">
  
  <meta name="description" content="My Blog/Website, will Tutorials, and just my general thoughts.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Advanced Bot Setup"/>
  <meta property="og:site_name" content="The Watchpost"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 5.0.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle navbar-org" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/" style="color: #6fec8e">The Watchpost</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" style="color: #ffffff" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/about" style="color: #ffffff" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/code/landing/" style="color: #ffffff" title="Discord.JS Bot Code">
			  <i class="fa fa-code"></i>Tutorials / Code
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" style="color: #ffffff" title="List of All Tags">
			  <i class="fa fa-tag"></i>Tags
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 

<div class="page-header">
	<h1>
		Advanced Bot Setup</h1>
	

</div>

	

<div class="row page">
	<!-- cols -->
	
		<div class="col-md-12">
			

			<!-- content -->
			<div class="mypage">
				

				<h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome!"></a>Welcome!</h2><p>In this tutorial we take the code from the <a href="/code/topics/discordjs/advancedbot">Advanced Bot Tutorial</a> and add onto it to create a Music feature set. </p>
<p>It is entirely possible to integrate this code into a bot that doesn’t follow the tutorial, in fact- it’s been written to explain very clearly where the files and code should go - however it may still be helpful to view the Advanced Bot Tutorial to ensure your bot is setup in a proper way, or so that you understand where the tutorial is referencing.</p>
<p><strong>Without</strong> further ado, let’s get into it!</p>
<hr>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>There are a few modules we need to install with NPM first, we need <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/ffmpeg">FFmpeg</a>*, <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/fluent-ffmpeg">Fluent-ffmpeg</a>, <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@discordjs/opus">@discord.js/opus</a>, and lastly <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/ytdl-core">ytdl-core</a></p>
<p>You can install them all with </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ffmpeg fluent-ffmpeg @discordjs/opus ytdl-core --save</span><br></pre></td></tr></table></figure>

<p>Now we must ensure FFmpeg is installed on the OS the bot is running on. For Debian based Linux Distros it is as easy as doing <code>sudo apt install ffmpeg</code> but for Windows users it is a bit more complicated.</p>
<p>For windows users you must first download FFmpeg from <a target="_blank" rel="noopener" href="https://ffmpeg.zeranoe.com/builds/">the official downloads page</a>.<br>From here you must do the following to ensure FFmpeg is registered</p>
<ul>
<li>Extract the download into a location of your choice</li>
<li>Rename the extracted folder to <code>FFmpeg</code> for clarity</li>
<li>Go to <code>Control Panel &gt; System and Security &gt; System &gt; Advanced System Settings</code></li>
<li>From here, click on <code>Environment Variables</code> in the Advanced Settings window</li>
<li>Double click on the <code>Path</code> value in the table shown</li>
<li>Click <code>new</code> to add a new variable to the path</li>
<li>Add your FFmpeg folder path into the table and click <code>ok</code></li>
<li>Restart your command line/terminal, and FFmpeg should be installed!</li>
</ul>
<p>Once FFmpeg is installed, you should be all set to move on!</p>
<hr>
<h2 id="Bot-Setup"><a href="#Bot-Setup" class="headerlink" title="Bot Setup"></a>Bot Setup</h2><p>We will need to add some new properties to the Client. To do this in a clean and future proof way, we will be storing the properties in a separate file, and requiring them in the <code>index.js</code> file we created in the Advanced Bot. For those not following from that tutorial, this should be the launching point for your bot, or where you store the Client creation and login.</p>
<p>To do this we should create a new folder under <code>/bot/connectors</code>, in other words, create a folder called <code>connectors</code> under the main folder for your bot. Make sure it is outside the commands and events folder!</p>
<p>Once you have done that, we need to create a <code>music.js</code> file to store the properties in. For this tutorial, we will use the following code in the <code>music.js</code> file</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">Client</span>) =&gt;</span> &#123;</span><br><span class="line">    Client.music = &#123;&#125; <span class="comment">// base object</span></span><br><span class="line">    Client.music.queue = <span class="keyword">new</span> <span class="built_in">Map</span>() <span class="comment">// a Map to store server queues</span></span><br><span class="line">    Client.music.servers = <span class="keyword">new</span> <span class="built_in">Map</span>() <span class="comment">// a Map to store server data/settings</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This code ensures we can use <code>require</code> to attach the properties to the Client. We will have a queue Map, and a servers Map to hold data.<br>Once you have the <code>music.js</code> file setup, we should go ahead and require it to “connect” it to the Client. Inside your <code>index.js</code> file place the following code</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;./connectors/music.js&quot;</span>)(Client)</span><br></pre></td></tr></table></figure>
<p>This passes in the Client to the <code>music.js</code> file! Now your properties exist on the bot and we can continue!</p>
<p>For reference, your folder structure should look something like this in the end.<br><img src="../../../../assets/musicbotstructure.PNG" alt="File Tree"></p>
<hr>
<h2 id="Play-Command"><a href="#Play-Command" class="headerlink" title="Play Command"></a>Play Command</h2><p>So now it’s time to get to playing music! Lets go ahead and make a <code>music</code> commands folder and category</p>
<p>WIP - Will be finished later</p>

				
			</div>


	
				<span id="/code/topics/discordjs/musicbot/" class="leancloud-visitors view"
					data-flag-title="Advanced Bot Setup">
					<em class="post-meta-item-text"> Page View </em> <i class="leancloud-visitors-count"></i>
				</span>
				
				<div>
					<center>

						<div class="pagination">

    
</div>


					</center>
				</div>

				<!-- comment -->
				<!--
-->
			</div> <!-- col-md-9/col-md-12 -->


			

		</div><!-- row -->

		<!--
 -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2019-2020
  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
